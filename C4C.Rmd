---
title: "C4C"
author: "Tyler Cobian"
date: "11/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Packages
```{r, include=FALSE}
library(tidyverse)
library(here)
library(kableExtra)
library(ggpubr)

```

Data
```{r, include=FALSE}
cotton<- read_csv(here("DATA", "cotton_combined.csv"))
kernza<- read_csv(here("DATA", "kernza_total.csv"))
kernza_updated<- read_csv(here("DATA", "kernza_updated.csv"))
mango<- read_csv(here("DATA", "mango_total.csv"))
bison_nc<- read_csv(here("DATA", "bison_total_no_climate.csv"))
bison<- read_csv(here("DATA", "bison_total.csv"))
bison_indi<- read_csv(here("DATA", "bison_individual_sensativity.csv"))
bison_comp<- read_csv(here("DATA", "bison_compiling_sensativity.csv"))
bison_grazing<- read_csv(here("DATA", "bison_grazing_sensativity.csv"))

```

Graph #1 (Time Series SOC) AI
```{r}

```

Graph #2 (Time Series GWP) AI
```{r}

```

Graph #3 (Bar SOC & GWP) AI
```{r}

```

Graph #4 (Bar N2O $ CH4) TC
```{r}
options(scipen = 999)
# find the mean n2o and ch4 for regen and oragnic for each crop in the base site
# base sites 
# Kernza: Minnesota
# Mango: Nicaragua
# Cotton: Texas
# Bison: Sputh Dakota
kernza_regen_n2o<- mean(kernza$N2O_CO2e[55:72])
kernza_organic_n2o<- mean(kernza$N2O_CO2e[37:54])
kernza_regen_ch4<- mean(kernza$CH4_CO2e[55:72])
kernza_organic_ch4<- mean(kernza$CH4_CO2e[37:54])

mango_regen_n2o<- ((mean(mango$N2O_flux[37:54])/28)*66)*265
mango_organic_n2o<- ((mean(mango$N2O_flux[55:72])/28)*66)*265
mango_regen_ch4<- ((mean(mango$CH4[37:54])/12)*16)*28
mango_organic_ch4<- ((mean(mango$CH4[55:72])/12)*16)*28

cotton_regen_n2o<- mean(cotton$N2O[103:120])
cotton_organic_n2o<- mean(cotton$CH4[23:40])
cotton_regen_ch4<- mean(cotton$CH4[103:120])
cotton_oragnic_ch4<- mean(cotton$CH4[23:40])

bison_regen_n2o<- mean(bison$N2O_GWP[63:80])
bison_organic_n2o<- mean(bison$N2O_GWP[43:60])
bison_regen_ch4<- mean(bison$CH4_GWP[63:80])
bison_organic_ch4<- mean(bison$CH4_GWP[43:60])

# make a data set of these averages

n2o_ch4<- data.frame(Crop = c("Kernza", "Kernza", "Kernza", "Kernza", "Mango", "Mango","Mango", "Mango", "Cotton", "Cotton", "Cotton", "Cotton", "Bison", "Bison", "Bison", "Bison"),
                   Practice = c("Regenerative", "Organic", "Regenerative", "Organic", "Regenerative", "Organic", "Regenerative", "Organic"),
                   Gas = c("N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4"),
                   kg_co2e = c(kernza_regen_n2o, kernza_organic_n2o, kernza_regen_ch4, kernza_organic_ch4, mango_regen_n2o, mango_organic_n2o, mango_regen_ch4, mango_organic_ch4, cotton_regen_n2o, cotton_organic_n2o, cotton_regen_ch4, cotton_oragnic_ch4, bison_regen_n2o, bison_organic_n2o, bison_regen_ch4, bison_organic_ch4))

ch4_n20_kernza<- n2o_ch4 %>% 
  filter(Crop == "Kernza") %>% 
  group_by(Practice)


ch4_n20_cotton<- n2o_ch4 %>% 
  filter(Crop == "Cotton") %>% 
  group_by(Practice)

ch4_n20_mango<- n2o_ch4 %>% 
  filter(Crop == "Mango") %>% 
  group_by(Practice)

ch4_n20_bison<- n2o_ch4 %>% 
  filter(Crop == "Bison") %>% 
  group_by(Practice)

ch4_n20_regen_plot<- ggplot(ch4_n2o_regen, aes(y = kg_co2e, x = Crop, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("deepskyblue2", "cadetblue4"))+
  labs(title = "Regenerative", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_regen_plot

ch4_n20_organic_plot<- ggplot(ch4_n2o_organic, aes(y = kg_co2e, x = Crop, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Organic", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_organic_plot

ggarrange(ch4_n20_regen_plot, ch4_n20_organic_plot)

ch4_n20_kernza_plot<- ggplot(ch4_n20_kernza, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Kernza", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_kernza_plot

ch4_n20_cotton_plot<- ggplot(ch4_n20_cotton, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Cotton", y = element_blank(), x = element_blank())+
  theme_classic()
ch4_n20_cotton_plot

ch4_n20_mango_plot<- ggplot(ch4_n20_mango, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Mango", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_mango_plot

ch4_n20_bison_plot<- ggplot(ch4_n20_bison, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Bison", y = element_blank(), x = element_blank())+
  theme_classic()
ch4_n20_bison_plot

ggarrange(ch4_n20_kernza_plot, ch4_n20_cotton_plot, ch4_n20_mango_plot, ch4_n20_bison_plot)

# make a bar chart of the n2o_ch4 data frame
```

Graph #5 (Bar Location) TC
```{r}

```

Graph #6 (Bar Climate) TC
```{r}

```

Graph #7 (Bar compost/manure sensativity) ID
```{r}

```

Graph #8 (Bar crop sensativity) ID
```{r}

```

Graph #9 (Bar tillage sensativity) ID
```{r}

```

Save Graphs as jpg
```{r}

```

