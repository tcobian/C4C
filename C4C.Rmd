---
title: "C4C"
author: "Tyler Cobian"
date: "11/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Packages
```{r, include=FALSE}
library(tidyverse)
library(here)
library(kableExtra)
library(ggpubr)

```

Data
```{r, include=FALSE}
cotton<- read_csv(here("DATA", "cotton_combined.csv"))
kernza<- read_csv(here("DATA", "kernza_total.csv"))
kernza_updated<- read_csv(here("DATA", "kernza_updated.csv"))
mango<- read_csv(here("DATA", "mango_total.csv"))
bison_nc<- read_csv(here("DATA", "bison_total_no_climate.csv"))
bison<- read_csv(here("DATA", "bison_total.csv"))
bison_indi<- read_csv(here("DATA", "bison_individual_sensativity.csv"))
bison_comp<- read_csv(here("DATA", "bison_compiling_sensativity.csv"))
bison_grazing<- read_csv(here("DATA", "bison_grazing_sensativity.csv"))

```

Graph #1 (Time Series SOC) AI
```{r}

```

Graph #2 (Time Series GWP) AI
```{r}

```

Graph #3 (Bar SOC & GWP) AI
```{r}

```

Graph #4 (Bar N2O $ CH4) TC
```{r}
options(scipen = 999)
# find the mean n2o and ch4 for regen and oragnic for each crop in the base site
# base sites 
# Kernza: Minnesota
# Mango: Nicaragua
# Cotton: Texas
# Bison: Sputh Dakota
kernza_regen_n2o<- mean(kernza$N2O_CO2e[55:72])
kernza_organic_n2o<- mean(kernza$N2O_CO2e[37:54])
kernza_regen_ch4<- mean(kernza$CH4_CO2e[55:72])
kernza_organic_ch4<- mean(kernza$CH4_CO2e[37:54])

mango_regen_n2o<- ((mean(mango$N2O_flux[37:54])/28)*66)*265
mango_organic_n2o<- ((mean(mango$N2O_flux[55:72])/28)*66)*265
mango_regen_ch4<- ((mean(mango$CH4[37:54])/12)*16)*28
mango_organic_ch4<- ((mean(mango$CH4[55:72])/12)*16)*28

cotton_regen_n2o<- mean(cotton$N2O[103:120])
cotton_organic_n2o<- mean(cotton$CH4[23:40])
cotton_regen_ch4<- mean(cotton$CH4[103:120])
cotton_oragnic_ch4<- mean(cotton$CH4[23:40])

bison_regen_n2o<- mean(bison$N2O_GWP[63:80])
bison_organic_n2o<- mean(bison$N2O_GWP[43:60])
bison_regen_ch4<- mean(bison$CH4_GWP[63:80])
bison_organic_ch4<- mean(bison$CH4_GWP[43:60])

# make a data set of these averages

n2o_ch4<- data.frame(Crop = c("Kernza", "Kernza", "Kernza", "Kernza", "Mango", "Mango","Mango", "Mango", "Cotton", "Cotton", "Cotton", "Cotton", "Bison", "Bison", "Bison", "Bison"),
                   Practice = c("Regenerative", "Organic", "Regenerative", "Organic", "Regenerative", "Organic", "Regenerative", "Organic"),
                   Gas = c("N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4", "N2O", "N2O", "CH4", "CH4"),
                   kg_co2e = c(kernza_regen_n2o, kernza_organic_n2o, kernza_regen_ch4, kernza_organic_ch4, mango_regen_n2o, mango_organic_n2o, mango_regen_ch4, mango_organic_ch4, cotton_regen_n2o, cotton_organic_n2o, cotton_regen_ch4, cotton_oragnic_ch4, bison_regen_n2o, bison_organic_n2o, bison_regen_ch4, bison_organic_ch4))

ch4_n20_kernza<- n2o_ch4 %>% 
  filter(Crop == "Kernza") %>% 
  group_by(Practice)

ch4_n20_cotton<- n2o_ch4 %>% 
  filter(Crop == "Cotton") %>% 
  group_by(Practice)

ch4_n20_mango<- n2o_ch4 %>% 
  filter(Crop == "Mango") %>% 
  group_by(Practice)

ch4_n20_bison<- n2o_ch4 %>% 
  filter(Crop == "Bison") %>% 
  group_by(Practice)

ch4_n20_kernza_plot<- ggplot(ch4_n20_kernza, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Kernza", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_kernza_plot

ch4_n20_cotton_plot<- ggplot(ch4_n20_cotton, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Cotton", y = element_blank(), x = element_blank())+
  theme_classic()
ch4_n20_cotton_plot

ch4_n20_mango_plot<- ggplot(ch4_n20_mango, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Mango", y = "kgCO2e", x = element_blank())+
  theme_classic()
ch4_n20_mango_plot

ch4_n20_bison_plot<- ggplot(ch4_n20_bison, aes(y = kg_co2e, x = Gas, fill = Gas))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Practice)+
  scale_fill_manual(values = c("darkolivegreen1", "darkolivegreen"))+
  labs(title = "Bison", y = element_blank(), x = element_blank())+
  theme_classic()
ch4_n20_bison_plot

ch4_n2o_total<- plot(ggarrange(ch4_n20_kernza_plot, ch4_n20_cotton_plot, ch4_n20_mango_plot, ch4_n20_bison_plot))

ch4_n2o_total

# make a bar chart of the n2o_ch4 data frame
```

Graph #5 (Bar Location) TC
```{r}
##############
# Kernza
#############
##### SOC
kernza_uk_regen_soc<- sum(kernza$End_SOC[1:18])
kernza_uk_organic_soc<- sum(kernza$End_SOC[19:36])

kernza_min_regen_soc<- sum(kernza$End_SOC[55:72])
kernza_min_organic_soc<- sum(kernza$End_SOC[37:54])

kernza_ks_regen_soc<- sum(kernza$End_SOC[91:108])
kernza_ks_organic_soc<- sum(kernza$End_SOC[73:90])

###### GWP

kernza_uk_regen_gwp<- sum(kernza$GWP[1:18])
kernza_uk_organic_gwp<- sum(kernza$GWP[19:36])

kernza_min_regen_gwp<- sum(kernza$GWP[55:72])
kernza_min_organic_gwp<- sum(kernza$GWP[37:54])

kernza_ks_regen_gwp<- sum(kernza$GWP[91:108])
kernza_ks_organic_gwp<- sum(kernza$GWP[73:90])

# making the data set

kernza_location<- data.frame(Location = c("Scotland", "Scotland","Minnesota", "Minnesota", "Kansas", "Kansas"),
                             Practice = c("Regenerative", "Organic","Regenerative", "Organic","Regenerative", "Organic"),
                             SOC = c(kernza_uk_regen_soc, kernza_uk_organic_soc, kernza_min_regen_soc, kernza_min_organic_soc, kernza_ks_regen_soc, kernza_ks_organic_soc),
                             GWP = c(kernza_uk_regen_gwp, kernza_uk_organic_gwp, kernza_min_regen_gwp, kernza_min_organic_gwp, kernza_ks_regen_gwp, kernza_ks_organic_gwp))

# plotting

kernza_location_soc_plot<- ggplot(kernza_location, aes(y = SOC, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("aquamarine4", "aquamarine"))+
  labs(title = "Kernza", y = "kgSOC/ha", x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
kernza_location_soc_plot

kernza_location_gwp_plot<- ggplot(kernza_location, aes(y = GWP, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("aquamarine4", "aquamarine"))+
  labs(title = "Kernza", y = "kgco2e", x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
kernza_location_gwp_plot

#########
# Cotton
########
###### SOC
cotton_china_regen_soc<- sum(cotton$End_SOC[83:100])
cotton_china_organic_soc<- sum(cotton$End_SOC[3:20])

cotton_india_regen_soc<- sum(cotton$End_SOC[123:140])
cotton_india_organic_soc<- sum(cotton$End_SOC[43:60])

cotton_texas_regen_soc<- sum(cotton$End_SOC[103:120])
cotton_texas_organic_soc<- sum(cotton$End_SOC[23:40])

cotton_peru_regen_soc<- sum(cotton$End_SOC[143:160])
cotton_peru_organic_soc<- sum(cotton$End_SOC[63:80])

######### GWP

cotton_china_regen_gwp<- sum(cotton$GWP[83:100])
cotton_china_organic_gwp<- sum(cotton$GWP[3:20])

cotton_india_regen_gwp<- sum(cotton$GWP[123:140])
cotton_india_organic_gwp<- sum(cotton$GWP[43:60])

cotton_texas_regen_gwp<- sum(cotton$GWP[103:120])
cotton_texas_organic_gwp<- sum(cotton$GWP[23:40])

cotton_peru_regen_gwp<- sum(cotton$GWP[143:160])
cotton_peru_organic_gwp<- sum(cotton$GWP[63:80])

# Making the data set

cotton_location<- data.frame(Location = c("China", "China","India", "India", "Texas", "Texas", "Peru", "Peru"),
                             Practice = c("Regenerative", "Organic","Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic"),
                             SOC = c(cotton_china_regen_soc, cotton_china_organic_soc, cotton_india_regen_soc, cotton_india_organic_soc, cotton_texas_regen_soc, cotton_texas_organic_soc, cotton_peru_regen_soc, cotton_peru_organic_soc),
                           GWP = c(cotton_china_regen_gwp, cotton_china_organic_gwp, cotton_india_regen_gwp, cotton_india_organic_gwp, cotton_texas_regen_gwp, cotton_texas_organic_gwp, cotton_peru_regen_gwp, cotton_peru_organic_gwp))

# Plotting

cotton_location_soc_plot<- ggplot(cotton_location, aes(y = SOC, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("deepskyblue4", "deepskyblue"))+
  labs(title = "Cotton", y = element_blank(), x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
cotton_location_soc_plot

cotton_location_gwp_plot<- ggplot(cotton_location, aes(y = GWP, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("deepskyblue4", "deepskyblue"))+
  labs(title = "Cotton", y = element_blank(), x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
cotton_location_gwp_plot

#######
# Mango
######
######## SOC
mango_india_regen_soc<- sum(mango$End_SOC[1:18])
mango_india_organic_soc<- sum(mango$End_SOC[19:36])

mango_nicaragua_regen_soc<- sum(mango$End_SOC[37:54])
mango_nicaragua_organic_soc<- sum(mango$End_SOC[55:72])
######## GWP

mango_india_regen_gwp<- ((sum(mango$End_SOC[1:18])/12)*66) + (((sum(mango$CH4[1:18])/12)*16)*28) + (((sum(mango$N2O_flux[1:18])/28)*66)*265)

mango_india_organic_gwp<- ((sum(mango$End_SOC[19:36])/12)*66) + (((sum(mango$CH4[19:36])/12)*16)*28) + (((sum(mango$N2O_flux[19:36])/28)*66)*265)

mango_nicaragua_regen_gwp<- ((sum(mango$End_SOC[37:54])/12)*66) + (((sum(mango$CH4[37:54])/12)*16)*28) + (((sum(mango$N2O_flux[37:54])/28)*66)*265)

mango_nicaragua_organic_gwp<- ((sum(mango$End_SOC[55:72])/12)*66) + (((sum(mango$CH4[55:72])/12)*16)*28) + (((sum(mango$N2O_flux[55:72])/28)*66)*265)
  
# Make the data set

mango_location<- data.frame(Location = c("India", "India","Nicaragua", "Nicaragua"),
                             Practice = c("Regenerative", "Organic","Regenerative", "Organic"),
                             SOC = c(mango_india_regen_soc, mango_india_organic_soc, mango_nicaragua_regen_soc, mango_nicaragua_organic_soc),
                           GWP = c(mango_india_regen_gwp, mango_india_organic_gwp, mango_nicaragua_regen_gwp, mango_nicaragua_organic_gwp))

# make the plots

mango_location_soc_plot<- ggplot(mango_location, aes(y = SOC, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("darkorange4", "darkorange"))+
  labs(title = "Mango", y = "kgSOC/ha", x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
mango_location_soc_plot

mango_location_gwp_plot<- ggplot(mango_location, aes(y = GWP, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("darkorange4", "darkorange"))+
  labs(title = "Mango", y = "kgCO2e", x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
mango_location_gwp_plot

##################
# Bison
##################

bison_sd_regen_soc<- sum(bison$End_SOC[63:80])
bison_sd_organic_soc<- sum(bison$End_SOC[45:60])

bison_bz_regen_soc<- sum(bison$End_SOC[23:40])
bison_bz_organic_soc<- sum(bison$End_SOC[3:20])

bison_sd_regen_gwp<- sum(bison$GWP[63:80])
bison_sd_organic_gwp<- sum(bison$GWP[45:60])

bison_bz_regen_gwp<- sum(bison$GWP[23:40])
bison_bz_organic_gwp<- sum(bison$GWP[3:20])

# make the dataset
bison_location<- data.frame(Location = c("South Dakota", "South Dakota","Brazil", "Brazil"),
                             Practice = c("Regenerative", "Organic","Regenerative", "Organic"),
                             SOC = c(bison_sd_regen_soc, bison_sd_organic_soc, bison_bz_regen_soc, bison_bz_organic_soc),
                           GWP = c(bison_sd_regen_gwp, bison_sd_organic_gwp, bison_bz_regen_gwp, bison_bz_organic_gwp))

# make the plots

bison_location_soc_plot<- ggplot(bison_location, aes(y = SOC, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("darkslategray", "darkseagreen4"))+
  labs(title = "Bison", y = element_blank(), x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
bison_location_soc_plot

bison_location_gwp_plot<- ggplot(bison_location, aes(y = GWP, x = Location, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  scale_fill_manual(values = c("darkslategray", "darkseagreen4"))+
  labs(title = "Bison", y = element_blank(), x = element_blank())+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
bison_location_gwp_plot

# accumilate the plots
location_soc_plots<- ggarrange(kernza_location_soc_plot, cotton_location_soc_plot, mango_location_soc_plot, bison_location_soc_plot)

location_soc_plots

location_gwp_plots<- ggarrange(kernza_location_gwp_plot, cotton_location_gwp_plot, mango_location_gwp_plot, bison_location_gwp_plot)

location_soc_plots
location_gwp_plots

location_plots<- ggarrange(location_soc_plots, location_gwp_plots,
                           ncol = 2, nrow = 1)
location_plots


#### Try to make one data frame and one graph

location_df<- data.frame(location = c("Scotland", "Scotland","Minnesota", "Minnesota", "Kansas", "Kansas", "China", "China","India", "India", "Texas", "Texas", "Peru", "Peru", "India", "India","Nicaragua", "Nicaragua", "South Dakota", "South Dakota","Brazil", "Brazil"),
                         Practice = c("Regenerative", "Organic","Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic","Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic", "Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic","Regenerative", "Organic", "Regenerative", "Organic"),
                         SOC = c(kernza_uk_regen_soc, kernza_uk_organic_soc, kernza_min_regen_soc, kernza_min_organic_soc, kernza_ks_regen_soc, kernza_ks_organic_soc, cotton_china_regen_soc, cotton_china_organic_soc, cotton_india_regen_soc, cotton_india_organic_soc, cotton_texas_regen_soc, cotton_texas_organic_soc, cotton_peru_regen_soc, cotton_peru_organic_soc, mango_india_regen_soc, mango_india_organic_soc, mango_nicaragua_regen_soc, mango_nicaragua_organic_soc, bison_sd_regen_soc, bison_sd_organic_soc, bison_bz_regen_soc, bison_bz_organic_soc),
                         GWP = c(kernza_uk_regen_gwp, kernza_uk_organic_gwp, kernza_min_regen_gwp, kernza_min_organic_gwp, kernza_ks_regen_gwp, kernza_ks_organic_gwp, cotton_china_regen_gwp, cotton_china_organic_gwp, cotton_india_regen_gwp, cotton_india_organic_gwp, cotton_texas_regen_gwp, cotton_texas_organic_gwp, cotton_peru_regen_gwp, cotton_peru_organic_gwp, mango_india_regen_gwp, mango_india_organic_gwp, mango_nicaragua_regen_gwp, mango_nicaragua_organic_gwp, bison_sd_regen_gwp, bison_sd_organic_gwp, bison_bz_regen_gwp, bison_bz_organic_gwp),
                         Crop = "Kernza", "Kernza", "Kernza", "Kernza", "Kernza", "Kernza", "Cotton", "Cotton","Cotton","Cotton","Cotton","Cotton","Cotton","Cotton","Cotton","Cotton", "Mango", "Mango", "Mango", "Mango", "Bison", "Bison", "Bison", "Bison")
```

Graph #6 (Bar Climate) TC
```{r}

```

Graph #7 (Bar compost/manure sensitivity) ID
```{r}


```

Graph #8 (Bar crop sensitivity) ID
```{r}

```

Graph #9 (Bar tillage sensitivity) ID
```{r}

cotton_tillage<-cotton %>% 
  filter(Practice=="Tillage"| Practice=="Regenerative")

cotton_regen_india_nt_s<- mean(cotton_tillage$End_SOC[60:41])
cotton_regen_china_nt_s<-mean(cotton_tillage$End_SOC[20:1])
cotton_regen_texas_nt_s<-mean(cotton_tillage$End_SOC[40:21])
cotton_regen_peru_nt_s<-mean(cotton_tillage$End_SOC[80:61])

cotton_till_india_s<-mean(cotton_tillage$End_SOC[100:81])
cotton_till_china_s<-mean(cotton_tillage$End_SOC[120:101])
cotton_till_texas_s<-mean(cotton_tillage$End_SOC[160:141])
cotton_till_peru_s<-mean(cotton_tillage$End_SOC[140:121])


bison_regen_ch4<- mean(bison$CH4_GWP[63:80])
cotton_regen_india_nt_g<- mean(cotton_tillage$GWP[60:43])
cotton_regen_china_nt_g<-mean(cotton_tillage$GWP[20:3])
cotton_regen_texas_nt_g<-mean(cotton_tillage$GWP[40:23])
cotton_regen_peru_nt_g<-mean(cotton_tillage$GWP[80:63])

cotton_till_india_g<-mean(cotton_tillage$GWP[100:83])
cotton_till_china_g<-mean(cotton_tillage$GWP[120:103])
cotton_till_texas_g<-mean(cotton_tillage$GWP[160:143])
cotton_till_peru_g<-mean(cotton_tillage$GWP[140:123])

tillage_data<- data.frame(Country = c("India", "India", "China", "China", "Texas", "Texas","Peru", "Peru"),
                   Practice = c("Regenerative", "Regenerative+Tillage", "Regenerative", "Regenerative+Tillage", "Regenerative", "Regenerative+Tillage", "Regenerative", "Regenerative+Tillage"),
                   GWP = c(cotton_regen_india_nt_g, cotton_till_india_g,cotton_regen_china_nt_g, cotton_till_china_g,cotton_regen_texas_nt_g, cotton_till_texas_g, cotton_regen_peru_nt_g, cotton_till_peru_g),
                   SOC=c(cotton_regen_india_nt_s, cotton_till_india_s,cotton_regen_china_nt_s, cotton_till_china_s,cotton_regen_texas_nt_s, cotton_till_texas_s, cotton_regen_peru_nt_s, cotton_till_peru_s)) %>% 
  group_by(Practice)
              


tillage_SOC<- ggplot(tillage_data, aes(y = SOC, x = Practice, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Country, scales = "free")+
  scale_fill_manual(values = c("darkorchid4", "darkorange2"))+
  labs(y ="SOC(kg/ha)")+
  theme_classic()

tillage_SOC

tillage_GWP<- ggplot(tillage_data, aes(y = GWP, x = Practice, fill = Practice))+
  geom_bar(stat = "identity", position = "dodge", show.legend = "False")+
  facet_wrap(~Country)+
  scale_fill_manual(values = c("darkorchid4", "darkorange2"))+
  labs(y ="kg CO2e/ha")+
  theme_classic()

tillage_GWP



```

Save Graphs as jpg
```{r}


```

